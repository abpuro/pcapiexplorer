(this["webpackJsonppcapi-explorer"]=this["webpackJsonppcapi-explorer"]||[]).push([[0],{101:function(e,t,a){},103:function(e,t,a){},109:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(33),i=a.n(r),l=(a(101),a(24)),o=a.n(l),c=a(37),u=a(17),p=a(18),h=a(20),m=a(19),d=a(22),g=a(21),f=(a(103),a(58)),y=a(143),v=a(149),b=a(141),E=a(150),k=a(79),N=(a(67),a(148)),x=a(157),S=a(28),O=a.n(S),C=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).runQuery=a.runQuery.bind(Object(d.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(d.a)(a)),a.onChange=a.onChange.bind(Object(d.a)(a)),a.state={apiurlvalue:"https://api.partnercenter.microsoft.com/v1/",scope:O.a.scopes[1],operations:[{key:"get",text:"GET"},{key:"post",text:"POST"}],Styles:{dropdown:{width:10}},accessToken:{},requestHeaders:{Authorization:"Bearer <token>",Accept:"application/json","client-request-id":"7391249f-cba0-467c-b026-7b3a60196422",Host:"api.partner.microsoft.com","Content-Type":"application/json"},loadclass:"request-none"},a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"runQuery",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,s,n,r,i,l,c=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.state.accessToken),e.prev=1,e.next=4,this.props.useragent.acquireTokenSilent({scopes:[this.state.scope]});case 4:(t=e.sent)&&(console.log("Hello"),t.account,this.setState({accessToken:t})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),{},"string"===typeof e.t0?(a=e.t0.split("|"),a.length>1?{message:a[1],debug:a[0]}:{message:e.t0}):{message:e.t0.message,debug:JSON.stringify(e.t0)};case 12:"",s=JSON.stringify(this.state.requestHeaders).replace("<token>",this.state.accessToken.accessToken),n=JSON.parse(s),r=this.state.apiurlvalue+this.state.f_url,(i=this.props).callback({statusCode:"fetching"}),this.setState({loadclass:"request-load"}),fetch(r,{method:this.state.f_operation,headers:new Headers(n)}).then((function(e){return e.json()})).then((function(e){c.setState({loadclass:"request-none"}),i.callback(e)})),null!=localStorage.getItem("pcapihistory")&&(l=JSON.parse(localStorage.getItem("pcapihistory").toString())),l?l.push({operation:this.state.f_operation,url:this.state.f_url,timeStamp:new Date}):l=[{operation:this.state.f_operation,url:this.state.f_url,timeStamp:new Date}],localStorage.setItem("pcapihistory",JSON.stringify(l));case 23:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleInputChange",value:function(e){var t,a,s=e.target;a="checkbox"===s.type?s.checked:s.value,t=s.name,this.setState(Object(f.a)({},t,a))}},{key:"onChange",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a?(this.setState({apiurlvalue:"https://api.partnercenter.microsoft.com/v1/"}),this.setState({scope:O.a.scopes[1]})):(this.setState({apiurlvalue:"https://api.partner.microsoft.com/v1.0/"}),this.setState({scope:O.a.scopes[0]}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.createElement("div",{className:"request"},s.createElement(x.a,{label:"Switch Partner API and Partner Center API",defaultChecked:!0,onText:"Partner Center API",offText:"Partner API",onChange:this.onChange}),s.createElement("div",{className:"url"},s.createElement("div",null,s.createElement(y.a,{options:this.state.operations,styles:this.state.dropdownStyles,onChange:function(t,a){return e.setState(Object(f.a)({},t.target.id,a.key))},id:"f_operation",defaultSelectedKey:"get"})),s.createElement("div",null,s.createElement(v.a,{prefix:this.state.apiurlvalue,ariaLabel:"Partner Center API for Normal, Germany and US Goverment",ref:function(t){return e.title=t},onChange:this.handleInputChange,name:"f_url",className:"urlfield"})),s.createElement("div",null,s.createElement(b.a,{text:"Run Query",onClick:this.runQuery,allowDisabledFocus:!0})," ")),s.createElement("div",{className:"requestdetail"},s.createElement(E.a,null,s.createElement(k.a,{headerText:"Request Body",headerButtonProps:{"data-order":1,"data-title":"My Files Title"}},s.createElement(v.a,{multiline:!0,rows:8,inputClassName:"requestdetail",onChange:this.handleInputChange,name:"f_requestBody"})),s.createElement(k.a,{headerText:"Request Headers",inputClassName:"requestdetail"},s.createElement(v.a,{multiline:!0,rows:8,value:JSON.stringify(this.state.requestHeaders,void 0,4),onChange:this.handleInputChange,name:"f_requestHeaders"})))),s.createElement("div",{className:this.state.loadclass},s.createElement(N.a,{label:"Loading... Please wait...",ariaLive:"assertive",labelPosition:"top"})))}}]),t}(s.Component),w=a(6),A=a(152);var j=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={operations:[{key:"get",text:"GET"},{key:"post",text:"POST"}],Styles:{dropdown:{width:80}},messageBarTypeValue:w.a.success,responseMessage:"Reponse Status will be reflected here"};w.a.success;return a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"request"},n.a.createElement("div",{className:"requestdetail"},n.a.createElement(A.a,{messageBarType:this.props.responseType,isMultiline:!1},this.props.responseMessage)),n.a.createElement("div",{className:"requestdetail"},n.a.createElement(E.a,null,n.a.createElement(k.a,{headerText:"Response Body",headerButtonProps:{"data-order":1,"data-title":"Response Body"}},n.a.createElement(v.a,{multiline:!0,rows:8,inputClassName:"requestdetail",value:JSON.stringify(this.props.data,void 0,4),className:"responseText"})),n.a.createElement(k.a,{headerText:"Response  Headers",inputClassName:"requestdetail"},n.a.createElement(v.a,{multiline:!0,rows:8,value:JSON.stringify(this.props.data),className:"responseText"})))))}}]),t}(n.a.Component),T=a(153),P=a(144),B=a(147),I=(a(69),function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(m.a)(t).call(this))).showPanel=e.showPanel.bind(Object(d.a)(e)),e.hidePanel=e.hidePanel.bind(Object(d.a)(e)),e.state={PanelShow:!1},e}return Object(g.a)(t,e),Object(p.a)(t,[{key:"showPanel",value:function(){this.setState({PanelShow:!0})}},{key:"hidePanel",value:function(){this.setState({PanelShow:!1})}},{key:"render",value:function(){return n.a.createElement("div",{className:"history-outer"},n.a.createElement("div",{className:"sidepanel-header"},"Manage Account and Profiles"),n.a.createElement("div",{className:"history-inner"},n.a.createElement(T.a,{className:"history-inner-text"},"Get the partner legal business profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Get an organization profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Get partner billing profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Get Microsoft Partner Network profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Get support profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Update the partner legal business profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Update the partner billing profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Update support profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Update an organization profile"),n.a.createElement(T.a,{className:"history-inner-text"},"Verify a partner MPN ID"),n.a.createElement(T.a,{className:"history-inner-text"},"Get a customer's subscriptions by partner MPN ID"),n.a.createElement(T.a,{className:"history-inner-text"},"Get customers of an indirect reseller"),n.a.createElement(T.a,{className:"history-inner-text"},"Get indirect resellers of a customer"),n.a.createElement(T.a,{className:"history-inner-text"},"Retrieve a list of indirect resellers")),n.a.createElement("div",null,n.a.createElement(T.a,{onClick:this.showPanel,className:"ms-MessageBar-innerText"}," Show more")),n.a.createElement(P.a,{isLightDismiss:!0,isOpen:this.state.PanelShow,onDismiss:this.hidePanel,closeButtonAriaLabel:"Close",headerText:"Partner Center Scenarios"},n.a.createElement("span",null,n.a.createElement(B.a,{className:"defaultChoiceGroup",defaultSelectedKey:"D",options:[{key:"A",text:"Analytics",disabled:!0},{key:"B",text:"Device Deployment",disabled:!0},{key:"C",text:"Configuration policies",disabled:!0},{key:"D",text:"Manage accounts and profiles"},{key:"E",text:"Manage billing",disabled:!0},{key:"F",text:"Billing cycle",disabled:!0},{key:"G",text:"Invoices",disabled:!0},{key:"H",text:"Manage customer accounts",disabled:!0},{key:"I",text:"Manage orders",disabled:!0},{key:"J",text:"Provide support",disabled:!0},{key:"K",text:"Referrals",disabled:!0},{key:"L",text:"Utilities",disabled:!0}],label:"Select Scenario",required:!0}))))}}]),t}(n.a.Component));function M(){localStorage.setItem("pcapihistory",null)}var q=function(e){function t(e){var a;Object(u.a)(this,t),a=Object(h.a)(this,Object(m.a)(t).call(this,e));var s=localStorage.getItem("pcapihistory");console.log(s);var n=null;return null!=s&&(n=JSON.parse(s.toString())),console.log(n),a.state={history:n},console.log(a.state.history),a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{class:"history-outer"},n.a.createElement("div",{class:"history-inner"},null!=this.state.history?this.state.history.map((function(e){return n.a.createElement("div",{key:e.timestamp,class:"ms-MessageBar-innerText"},n.a.createElement(T.a,{onClick:function(){alert("An @mentioned name was clicked.")},className:"history-link-text"},n.a.createElement("span",{class:"get"},e.operation),e.url),n.a.createElement("div",null),n.a.createElement("div",{class:"historytimestamp"},Date(e.timeStamp)),n.a.createElement("div",null,"\xa0"))})):n.a.createElement("div",{class:"history-inner-text"},"No History Found")),n.a.createElement("div",null,n.a.createElement(T.a,{onClick:M,className:"ms-MessageBar-innerText"}," Clear History")))}}]),t}(n.a.Component),R=a(142);function J(e){return e.isAuthenticated?n.a.createElement("div",null,n.a.createElement("a",{href:"#",alt:e.user.email}),e.user.displayName," ",n.a.createElement("span",{onClick:e.authButtonMethod}," (Sign Out)")):n.a.createElement("div",{onClick:e.authButtonMethod},"Sign In")}var G=function(e){function t(e){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).call(this,e))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(J,{isAuthenticated:this.props.isAuthenticated,authButtonMethod:this.props.authButtonMethod,user:this.props.user}))}}]),t}(n.a.Component),H=a(83),_=a(159),D=a(84),U=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).updateResponse=a.updateResponse.bind(Object(d.a)(a)),a.userAgentApplication=new R.a({auth:{clientId:O.a.appId,authority:"https://login.microsoftonline.com/common"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}});var s=a.userAgentApplication.getAccount();return a.state={isAuthenticated:null!==s,user:{},error:null,AccessToken:"",response:{},messageBarTypeValue:w.a.info,responseMessage:"Reponse Status will be reflected here"},s&&(a.state={isAuthenticated:null!==s,user:{displayName:s.name,email:s.userName},error:null,AccessToken:"",response:{},messageBarTypeValue:w.a.info,responseMessage:"Reponse Status will be reflected here"}),a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"login",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.loginPopup({prompt:"select_account",scopes:O.a.scopes});case 3:return e.next=5,this.getUserProfile();case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),t={},"string"===typeof e.t0?(a=e.t0.split("|"),t=a.length>1?{message:a[1],debug:a[0]}:{message:e.t0}):t={message:e.t0.message,debug:JSON.stringify(e.t0)},this.setState({isAuthenticated:!1,user:{},error:t,AccessToken:""});case 12:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.userAgentApplication.logout()}},{key:"getUserProfile",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,s,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.acquireTokenSilent({scopes:[O.a.scopes[1]]});case 3:(t=e.sent)&&(a=t.account,this.setState({isAuthenticated:!0,user:{displayName:a.name,email:a.userName},error:null,AccessToken:t})),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),s={},"string"===typeof e.t0?(n=e.t0.split("|"),s=n.length>1?{message:n[1],debug:n[0]}:{message:e.t0}):s={message:e.t0.message,debug:JSON.stringify(e.t0)},this.setState({isAuthenticated:!1,user:{},error:s,AccessToken:""});case 12:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"updateResponse",value:function(e){this.setState({response:e}),void 0!=e.statusCode?this.setState({messageBarTypeValue:w.a.error,responseMessage:e.statusCode+" "+e.message}):this.setState({messageBarTypeValue:w.a.success,responseMessage:e.code+" "+e.message})}},{key:"render",value:function(){var e=null;return this.state.error&&(e=n.a.createElement(A.a,{messageBarType:w.a.error,isMultiline:!0,dismissButtonAriaLabel:"Close"},this.state.error.message,this.state.error.debug)),n.a.createElement(H.a,null,n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"NavBar"},n.a.createElement("div",{className:"logo ms-font-xl"},"Partner Center API & Partner API Explorer"),n.a.createElement(D.a,{href:"https://github.com/abpuro/pcapiexplorer/issues/new",target:"_blank",title:"Help the Platofr"},"Report a Bug"),n.a.createElement(G,{isAuthenticated:this.state.isAuthenticated,authButtonMethod:this.state.isAuthenticated?this.logout.bind(this):this.login.bind(this),user:this.state.user}))),n.a.createElement(_.a,null,e,n.a.createElement("div",{className:"body"},n.a.createElement("div",{className:"content"},n.a.createElement("div",{className:"query"},n.a.createElement(C,{primarystate:this.state,callback:this.updateResponse,useragent:this.userAgentApplication})),n.a.createElement("div",{className:"response"}),n.a.createElement(j,{data:this.state.response,responseType:this.state.messageBarTypeValue,responseMessage:this.state.responseMessage})),n.a.createElement("div",{className:"sidebar"},n.a.createElement(E.a,null,n.a.createElement(k.a,{headerText:"Scenarios",headerButtonProps:{"data-order":1,"data-title":"My Files Title"}},n.a.createElement(I,null)),n.a.createElement(k.a,{headerText:"History",inputClassName:"requestdetail"},n.a.createElement(q,null))))))))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},28:function(e,t){e.exports={appId:"29e5b139-6d72-4289-9028-c29517343e84",appKey:"ZFO0YRpRRSNONJ3XCeO1Y82JoZG7AEIk0whKUKT258I=",scopes:["https://api.partner.microsoft.com/user_impersonation","https://api.partnercenter.microsoft.com/user_impersonation"]}},67:function(e,t,a){},69:function(e,t,a){},96:function(e,t,a){e.exports=a(109)}},[[96,1,2]]]);
//# sourceMappingURL=main.760d469a.chunk.js.map